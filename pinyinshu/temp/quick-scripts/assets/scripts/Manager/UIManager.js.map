{"version":3,"sources":["UIManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Manager","sourcesContent":["import { BaseUI, UIClass } from \"../UI/BaseUI\";\n\nexport class UIManager\n{\n    private static instance: UIManager;\n    private uiList: BaseUI[] = [];\n    private uiRoot: cc.Node = null;\n    \n    public static getInstance(): UIManager\n    {\n        if(this.instance == null)\n        {\n            this.instance = new UIManager();\n        }\n        return this.instance;\n    }\n\n    constructor()\n    {\n        this.uiRoot = cc.find(\"Canvas\");\n    }\n\n    public openUI<T extends BaseUI>(uiClass: UIClass<T>, zOrder?: number, callback?: Function, onProgress?: Function, ...args: any[])\n    {\n        if(this.getUI(uiClass))\n        {\n            return;\n        }\n        cc.loader.loadRes(uiClass.getUrl(),(completedCount: number, totalCount: number, item: any)=>{\n            if(onProgress)\n            {\n                onProgress(completedCount, totalCount, item);\n            }\n        }, (error, prefab)=>\n        {\n            if(error)\n            {\n                cc.log(error);\n                return;\n            }\n            if(this.getUI(uiClass))\n            {\n                return;\n            }\n            let uiNode: cc.Node = cc.instantiate(prefab);\n            uiNode.parent = this.uiRoot;\n            //zOrder && uiNode.setLocalZOrder(zOrder);\n            if (zOrder) { uiNode.zIndex = zOrder; }\n            let ui = uiNode.getComponent(uiClass) as BaseUI;\n            ui.tag = uiClass;\n            this.uiList.push(ui);\n            if(callback)\n            {\n                callback(args);\n            }\n        });\n    }\n\n    public closeUI<T extends BaseUI>(uiClass: UIClass<T>)\n    {\n        for(let i = 0; i < this.uiList.length; ++i)\n        {\n            if(this.uiList[i].tag === uiClass)\n            {\n                this.uiList[i].node.destroy();\n                this.uiList.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n    public showUI<T extends BaseUI>(uiClass: UIClass<T>, callback?: Function)\n    {\n        let ui = this.getUI(uiClass);\n        if(ui)\n        {\n            ui.node.active = true;\n            ui.onShow();\n            if(callback)\n            {\n                callback();\n            }\n        }\n        else\n        {\n            this.openUI(uiClass, 0, ()=>{\n                callback&&callback();\n                let ui = this.getUI(uiClass);\n                ui.onShow();\n            });\n        }\n    }\n\n    public hideUI<T extends BaseUI>(uiClass: UIClass<T>)\n    {\n        let ui = this.getUI(uiClass);\n        if(ui)\n        {\n            ui.node.active = false;\n        }\n    }\n\n    public getUI<T extends BaseUI>(uiClass: UIClass<T>): BaseUI\n    {\n        for(let i = 0; i < this.uiList.length; ++i)\n        {\n            if(this.uiList[i].tag === uiClass)\n            {\n                return this.uiList[i];\n            }\n        }\n        return null;\n    }\n}"]}