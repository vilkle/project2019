{"version":3,"sources":["../../../../../../assets/scripts/UI/Item/assets/scripts/UI/Item/OverTips.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/scripts/UI/Item","sourcesContent":["import { BaseUI } from \"../BaseUI\";\nimport { Tools } from \"../../UIComm/Tools\";\nimport { UIManager } from \"../../Manager/UIManager\";\nimport { AudioManager } from \"../../Manager/AudioManager\";\n\n\nexport enum Type_Tile {\n    ZuoDaJieShu,\n    ChuangGuanChengGong,\n    TiaoZhanJieShu,\n    TiaoZhanChengGong,\n    ChuangGuanJieShu\n}\n\nexport const DefalutTitle = [\"作答结束\", \"闯关成功\", \"挑战结束\", \"挑战成功\", \"闯关结束\"];\n\nlet FontMap = {\n    \"作\": \"img_zuo\",\n    \"答\": \"img_da\",\n    \"结\": \"img_jie\",\n    \"束\": \"img_shu\",\n    \"成\": \"img_cheng\",\n    \"功\": \"img_gong\",\n    \"挑\": \"img_tiao\",\n    \"战\": \"img_zhan\",\n    \"闯\": \"img_chuang\",\n    \"关\": \"img_guan\",\n};\n\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport class OverTips extends BaseUI {\n\n    protected static className = \"OverTips\";\n\n    @property(cc.Label)\n    private label_tip: cc.Label = null;\n\n    @property(sp.Skeleton)\n    private spine_false: sp.Skeleton = null;\n    @property(sp.Skeleton)\n    private spine_true: sp.Skeleton = null;\n    @property(sp.Skeleton)\n    private spine_complete: sp.Skeleton = null;\n    @property(cc.Node)\n    private node_close: cc.Node = null;\n    @property(cc.Node)\n    private button: cc.Node = null\n    private btnCallback = null\n    private callback = null;\n    private endInAnimation: boolean = false;\n    private img_titles: cc.Node[] = [];\n    private bones: any[] = [];\n\n    constructor() {\n        super();\n    }\n\n    onLoad() {\n        cc.loader.loadRes(\"images/OverTips/word\", cc.SpriteAtlas, function (err, atlas) { });\n    }\n\n    start() {\n        this.node_close.on(cc.Node.EventType.TOUCH_END, this.onClickClose, this);\n    }\n\n    onDisable() {\n        this.node_close.off(cc.Node.EventType.TOUCH_END, this.onClickClose, this);\n    }\n\n    /**\n     设置显示内容\n     @param {number} type          0: 错误  1：答对了  2：闯关成功(一直显示不会关闭)\n     @param {string} str           提示内容\n     @param {Function} callback    回调函数\n     @param {string} endTitle      end动效提示文字\n     */\n    init(type: number, str: string = \"\", btnStr: string = '', btnCallback: Function, callback: Function, endTitle?: string): void {\n        this.callback = callback;\n        this.spine_false.node.active = type == 0;\n        this.spine_true.node.active = type == 1;\n        this.spine_complete.node.active = type == 2;\n        this.label_tip.string = str;\n        this.label_tip.node.active = true;\n        switch (type) {\n            case 0:\n                this.node_close.active = true\n                Tools.playSpine(this.spine_false, \"false\", false, this.delayClose.bind(this));\n                AudioManager.getInstance().playSound(\"sfx_genneg\", false, 1);\n                this.button.active = false\n                this.button.getChildByName('Background').getChildByName('Label').getComponent(cc.Label).string = btnStr\n                this.btnCallback = btnCallback\n                break;\n            case 1:\n                this.node_close.active = true\n                Tools.playSpine(this.spine_true, \"true\", false, this.delayClose.bind(this));\n                AudioManager.getInstance().playSound(\"sfx_genpos\", false, 1);\n                this.button.active = false\n                break;\n            case 2:\n                this.node_close.active = false\n                this.spine_complete.node.active = false;\n                this.button.active = false\n                if (!endTitle) endTitle = DefalutTitle[0];\n                if (endTitle.length != 4) return;\n                this.bones = [];\n                this.bones.push(this.spine_complete.findBone(\"paipai\"));\n                this.bones.push(this.spine_complete.findBone(\"xiaoU\"));\n                this.bones.push(this.spine_complete.findBone(\"mimiya\"));\n                this.bones.push(this.spine_complete.findBone(\"doudou\"));\n                for (let index = 0; index < 4; index++) {\n                    this.createTitleImage(endTitle[index]);\n                }\n                break;\n        }\n        let endPos = this.label_tip.node.position;\n        let framePos_1 = cc.v2(endPos.x, endPos.y - 72.8);\n        let framePos_2 = cc.v2(endPos.x, endPos.y + 12);\n        let framePos_3 = cc.v2(endPos.x, endPos.y - 8);\n        let framePos_4 = cc.v2(endPos.x, endPos.y + 7.3);\n        this.label_tip.node.position = framePos_1;\n        this.label_tip.node.runAction(cc.sequence(cc.moveTo(0.08, framePos_2), cc.moveTo(0.08, framePos_3), cc.moveTo(0.08, framePos_4), cc.moveTo(0.06, endPos)));\n    }\n\n    delayClose(): void {\n        //this.scheduleOnce(function () { this.onClickClose() }.bind(this), 0);\n    }\n\n    onClickClose(event?, customEventData?): void {\n        if (event) AudioManager.getInstance().playSound(\"sfx_buttn\", false, 1);\n        if (this.callback) this.callback();\n        UIManager.getInstance().closeUI(OverTips);\n    }\n\n    buttonCallback() {\n        this.btnCallback()\n    }\n\n    createTitleImage(titleName: string) {\n        cc.loader.loadRes(\"images/OverTips/word\", cc.SpriteAtlas, function (err, atlas) {\n            if (err) {\n                console.log(err.message || err);\n                return;\n            }\n            let spriteFrame = atlas.getSpriteFrame(FontMap[titleName]);\n            let imageNode = new cc.Node();\n            let image = imageNode.addComponent(cc.Sprite);\n            image.spriteFrame = spriteFrame;\n            imageNode.parent = this.node;\n            imageNode.active = false;\n            this.img_titles.push(imageNode);\n            if (this.img_titles.length == 4) {\n                this.endInAnimation = true;\n                this.spine_complete.node.active = true;\n                Tools.playSpine(this.spine_complete, \"in\", false, () => {\n                    Tools.playSpine(this.spine_complete, \"stand\", true);\n                    this.endInAnimation = false;\n                });\n                AudioManager.getInstance().playSound(\"sfx_geupgrd\", false, 1);\n            }\n        }.bind(this));\n    }\n\n    update() {\n        if (!this.endInAnimation) return;\n        for (let index = 0; index < this.img_titles.length; index++) {\n            this.img_titles[index].active = true;\n            this.img_titles[index].position = cc.v2(this.bones[index].worldX - 139, this.bones[index].worldY - 135);\n        }\n    }\n}\n"]}