{"version":3,"sources":["UIManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Manager","sourcesContent":["import { BaseUI, UIClass } from \"../UI/BaseUI\";\n\nexport class UIManager {\n    private static instance: UIManager;\n    private uiList: BaseUI[] = [];\n    private uiRoot: cc.Node = null;\n\n    public static getInstance(): UIManager {\n        if (this.instance == null) {\n            this.instance = new UIManager();\n        }\n        return this.instance;\n    }\n\n    constructor() {\n        this.uiRoot = cc.find(\"Canvas\");\n    }\n\n    public openUI<T extends BaseUI>(uiClass: UIClass<T>, data?: any, zOrder?: number, callback?: Function, onProgress?: Function, ...args: any[]) {\n        if (this.getUI(uiClass)) {\n            return;\n        }\n        cc.loader.loadRes(uiClass.getUrl(), (completedCount: number, totalCount: number, item: any) => {\n            if (onProgress) {\n                onProgress(completedCount, totalCount, item);\n            }\n        }, (error, prefab) => {\n            if (error) {\n                cc.log(error);\n                return;\n            }\n            if (this.getUI(uiClass)) {\n                return;\n            }\n            let uiNode: cc.Node = cc.instantiate(prefab);\n            uiNode.parent = this.uiRoot;\n            //zOrder && uiNode.setLocalZOrder(zOrder);\n            if (zOrder) { uiNode.zIndex = zOrder; }\n            let ui = uiNode.getComponent(uiClass) as BaseUI;\n            ui.data = data;\n            ui.tag = uiClass;\n            this.uiList.push(ui);\n            if (callback) {\n                callback(args);\n            }\n        });\n    }\n\n    public closeUI<T extends BaseUI>(uiClass: UIClass<T>) {\n        for (let i = 0; i < this.uiList.length; ++i) {\n            if (this.uiList[i].tag === uiClass) {\n                this.uiList[i].node.destroy();\n                this.uiList.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n    public showUI<T extends BaseUI>(uiClass: UIClass<T>, data?: any, callback?: Function) {\n        let ui = this.getUI(uiClass);\n        if (ui) {\n            ui.data = data;\n            ui.node.active = true;\n            ui.onShow();\n            if (callback) {\n                callback();\n            }\n        }\n        else {\n            this.openUI(uiClass, data, 0, () => {\n                callback && callback();\n                let ui = this.getUI(uiClass);\n                ui.onShow();\n            });\n        }\n    }\n\n    public hideUI<T extends BaseUI>(uiClass: UIClass<T>) {\n        let ui = this.getUI(uiClass);\n        if (ui) {\n            ui.node.active = false;\n        }\n    }\n\n    public getUI<T extends BaseUI>(uiClass: UIClass<T>): BaseUI {\n        for (let i = 0; i < this.uiList.length; ++i) {\n            if (this.uiList[i].tag === uiClass) {\n                return this.uiList[i];\n            }\n        }\n        return null;\n    }\n}"]}